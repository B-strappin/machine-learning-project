---
title: "Practical Machine Learning Final Project"
author: "Seth Sanford"
date: "August 24, 2014"
output: html_document
---

#Summary
This project requires you to dive into a large dataset of exercise enthusiasts and create a model based on this data in order to determine what type of exercise an individual is doing based on the data that is being created by their human activity monitor.

##Download the data and libraries
```{r}
library(data.table)
traindata <- read.csv("pml-training.csv", stringsAsFactors=FALSE, na.strings=c("NA",""))
testdata <- read.csv("pml-testing.csv", stringsAsFactors=FALSE, na.strings=c("NA",""))
```

##Process the data
Make classe variable in training dataset factor
```{r}
traindata$classe <- as.factor(traindata$classe)
```

Get rid of columns with all NAs
```{r}
traindata <- traindata[,complete.cases(t(traindata))]
testdata <- testdata[,complete.cases(t(testdata))]
```

Get rid of columns that are not measurements
```{r}
traindata <- traindata[,-c(1:7)]
testdata <- testdata[,-c(1:7)]
```

Remove rows in train set with NAs if any
```{r}
traindata <- traindata[complete.cases(traindata),]
```

##Fit a model to the processed training data
Create a model with random forest for a better than linear regression model
```{r}
library("randomForest")
modFit <- randomForest(classe ~ ., data=traindata)
```

Create character vector of predictions
```{r}
predictions <- predict(modFit,testdata)
predictions <- as.character(predictions)
```

Write out the character vector to individual files for submission
```{r}
pml_write_files = function(x){
    n = length(x)
    for(i in 1:n){
        filename = paste0("answers/problem_id_",i,".txt")
        write.table(x[i],file=filename,quote=FALSE,row.names=FALSE,col.names=FALSE)
    }
}

pml_write_files(predictions)
```
